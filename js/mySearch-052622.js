window.addEventListener("load",()=>{const e=()=>{const e=document.body.style;e.width="100%",e.overflow="hidden",btf.animateIn(document.getElementById("search-mask"),"to_show 0.5s"),btf.animateIn(document.querySelector("#local-search .search-dialog"),"titleScale 0.5s"),setTimeout(()=>{document.querySelector("#local-search-input input").focus()},100),async function(){const e=document.getElementById("loading-database"),n=document.getElementById("local-search-results"),a=document.getElementById("loading-status");var c=0;e.nextElementSibling.style.display="block",e.remove();const t=document.querySelector("#local-search-input input");t.setAttribute("placeholder","回车搜索"),t.addEventListener("keydown",async function(e){if(13==e.keyCode){e=this.value.trim();n.innerHTML="";let t='<div class="search-result-list">';e.length<=0||(a.innerHTML='<i class="fas fa-spinner fa-pulse"></i>',await fetch("https://search.nite07.com/search",{method:"POST",mode:"cors",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"key="+e}).then(e=>e.json()).then(e=>{c=e.data.length,e.data.forEach(function(e){t=t+('<div class="local-search__hit-item"><a href="/'+e.link+'" class="search-result-title">'+e.title)+"</a></div>"})}),0===c&&(t+='<div id="local-search__hits-empty">'+GLOBAL_CONFIG.localSearch.languages.hits_empty.replace(/\$\{query}/,this.value.trim())+"</div>"),t+="</div>",n.innerHTML=t,a.innerHTML="",window.pjax&&window.pjax.refresh(n))}})}(),document.addEventListener("keydown",function e(t){"Escape"===t.code&&(n(),document.removeEventListener("keydown",e))})},n=()=>{const e=document.body.style;e.width="",e.overflow="",btf.animateOut(document.querySelector("#local-search .search-dialog"),"search_close .5s"),btf.animateOut(document.getElementById("search-mask"),"to_hide 0.5s")},t=()=>{document.querySelector("#search-button > .search").addEventListener("click",e),document.getElementById("search-mask").addEventListener("click",n),document.querySelector("#local-search .search-close-button").addEventListener("click",n)};t(),window.addEventListener("pjax:complete",function(){"block"===getComputedStyle(document.querySelector("#local-search .search-dialog")).display&&n(),t()})});